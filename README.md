# USERHOME
Func GetThisSciteHandle($sSciteUserIsAdmin)     Local $aProcessWindows, $aProcessList = ProcessList("SciTE.exe")     For $n = 1 To UBound($aProcessList) - 1         $aProcessWindows = _WinAPI_EnumProcessWindows($aProcessList[$n][1], 1)         If @error Then ContinueLoop         If StringInStr(_WinAPI_GetProcessCommandLine($aProcessList[$n][1]), $sSciteUserIsAdmin) Then Return $aProcessWindows[1][0]     Next EndFunc   ;==>GetThisSciteHandle  Func getTheMenuFirst()     Local $hWin = GetThisSciteHandle($sSCITE_RunAsAdminStr) ; WinGetHandle("[CLASS:SciTEWindow]")     Local $hPrimaryMenu = _GUICtrlMenu_GetMenu($hWin)     Local $sMenu = "", $iCount = _GUICtrlMenu_GetItemCount($hPrimaryMenu) - 1     For $i = 0 To $iCount         $sMenu &amp;= _GUICtrlMenu_GetItemText($hPrimaryMenu, $i)     Next     If StringInStr($sMenu, "&amp;Options") Then Return SetError(0, $iCount + 1, 0)     Return SetError(1, $iCount + 1, 1) EndFunc   ;==>getTheMenuFirst  Func add_running_version_to_the_MenuBar()     Local $iMenuItem, $hWin = GetThisSciteHandle($sSCITE_RunAsAdminStr) ; WinGetHandle("[CLASS:SciTEWindow]")     Local $hPrimaryMenu = _GUICtrlMenu_GetMenu($hWin)     Local $hItem2 = _GUICtrlMenu_CreateMenu()     _GUICtrlMenu_InsertMenuItem($hPrimaryMenu, 44, "  -=[ currently running v" &amp; FileGetVersion(@ScriptDir &amp; '\AutoIt3.exe') &amp; " as " &amp; (IsAdmin() = 0 ? "user" : "admin") &amp; " ]=-  ", 0, $hItem2)     _GUICtrlMenu_DrawMenuBar($hWin) EndFunc   ;==>add_running_version_to_the_MenuBar  main() Func main()     EnvSet("SCITE_USERHOME", $sSCITE_USERHOME)     If Not GetThisSciteHandle($sSCITE_RunAsAdminStr) Then         If Not FileExists($sSCITE_USERHOME &amp; "\SciTEConfig") Then DirCreate($sSCITE_USERHOME &amp; "\SciTEConfig")         If StringInStr($sSCITE_EXE, " ") Then $sSCITE_EXE = '"' &amp; $sSCITE_EXE &amp; '"'         Run($sSCITE_EXE &amp; ' ' &amp; $sSCITE_RunAsAdminStr, $sSCITE_USERHOME)         WinWait("[CLASS:SciTEWindow]", "", 5)         Sleep(100)         While getTheMenuFirst()             Sleep(1000)             If TimerDiff($hTimer) > 20000 Then Exit 3         WEnd         add_running_version_to_the_MenuBar()     EndIf     For $n = 1 To $CmdLine[0]         Run($sSCITE_EXE &amp; ' "' &amp; $CmdLine[$n] &amp; '" ' &amp; $sSCITE_RunAsAdminStr, $sSCITE_USERHOME)     Next     Run($sSCITE_EXE &amp; ' ' &amp; $sSCITE_RunAsAdminStr, $sSCITE_USERHOME) EndFunc   ;==>main
